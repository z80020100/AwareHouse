<!DOCTYPE html>


<html>

<head>
<title>W3.CSS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="./templates/w3.css">

<!---- CDN ---->
<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

</head>
<body>



<div data-role="page"  id="main" >

<div data-role="panel" id="admin_panel" class="w3-sidenav w3-white w3-card-2" data-position="left" data-display="reveal" data-theme="a">

  <a href="#a0" 
  data-rel="close"
  class="w3-closenav w3-large w3-xxlarge w3-center">&times;</a>

  <a href="#a0" class="w3-center">即時訂單資訊</a>		
  <br>
  <a href="#a1" class="w3-center">報表產生</a>		
  <br>
  <a href="#a2" class="w3-center">菜單更新</a>		
  <br>
  <a href="login.php" class="w3-center">登出</a>
</div>

<div data-role="header">

    <header class="w3-container w3-teal">
      <span class="w3-opennav w3-xlarge"><a href="#admin_panel" style="text-decoration: none; color:#FFFFFF;">&#9776;</a></span>
      <h1><center>早餐店後台管理系統</center></h1>
    </header>

</div>

<div data-role="content">
    <div id="a0" class="w3-container">
        <h3><center>即時訂單資訊</center></h3>

	<table class="w3-table w3-bordered w3-striped w3-border w3-hoverable" id="order_list" >
		<tr>
			<th>狀態</th>
			<th>桌號</th>
			<th>人數</th>
			<th>總價錢</th>
			<th>操作</th>		
		</tr>
		<!----- Order START ------>
		<tr class="order_title" order_id="1">
			<th>已出餐</th>
			<th>#12</th>
			<th>3</th>
			<th>$160</th>
			<th>
				<fieldset data-role="controlgroup" data-type="horizontal">
					<a href="#" data-role="button" data-transition="fade" class="button_viewsum ui-btn-active" order_id="1">單子總結</a>
					<a href="#" data-role="button" data-transition="fade" class="button_calshare" >計算小單價格</a>
				</fieldset>
			</th>			
		</tr>
		
		<tr id="order_detail_1" class="order_detail order_done" order_id="1"> 
			<td colspan=5 class="viewsummary">
				<!--- viewsummary ---->
				<table>
					<tr>
						<td>漢堡</td><td>加起司</td><td>$50</td><td>x1</td>
					</tr>
					<tr>
						<td>沙拉</td><td>加起司</td><td>$70</td><td>x1</td>
					</tr>
					<tr>
						<td>豆漿</td><td>溫,無糖</td><td>$20</td><td>x3</td>
					</tr>
				</table>
			</td>
			<!--- viewshare ---->
			<td colspan=5 class="viewshare">
				<table>
				<tr><td>$70</td>
					<td>
					<table>
						<tr><td>漢堡</td><td>加起司</td><td>$50</td><td>x1</td></tr>
						<tr><td>豆漿</td><td>溫,無糖</td><td>$20</td><td>x1</td></tr>
					</table>
					</td>
				</tr>
				<tr><td>$90</td>
					<td>
					<table>
						<tr><td>沙拉</td><td>加起司</td><td>$70</td><td>x1</td></tr>
						<tr><td>豆漿</td><td>溫,無糖</td><td>$20</td><td>x1</td></tr>
					</table>
					</td>
				</tr>		
				<tr><td>$20</td>
					<td>
					<table>
						<tr><td>豆漿</td><td>溫,無糖</td><td>$20</td><td>x1</td></tr>
					</table>
					</td>
				</tr>		
				</table>
			</td>
		</tr>		
		<!----- Order END------>
	</table>

    </div>
    
    <div>&nbsp;</div>
 </div>
 
 <div data-role="footer">
    <footer class="w3-container w3-teal">
      <p> &nbsp; </p>
    </footer>

</div>
      
<script>

//--------單子顯示相關的函式------------------------------
//
//	ordershow 顯示整張單子，包含viewsummary跟viewshare
//	viewsummary 單子總結
//	viewshare 以小單為單位顯示
//
//--------------------------------------------------------

//function toggle_ordershow( id ){
//	order_filter = "#order_detail_"+id;
//	$(order_filter).toggle();
//}


function order_status_down(id){
	order_detail = "#order_detail_" + id;
	if( $(order_detail).hasClass("order_done")){
		$(order_detail).removeClass("order_done");
		$(order_detail).addClass("order_making");		
	}
	else if( $(order_detail).hasClass("order_making") ){
		$(order_detail).removeClass("order_making");
		$(order_detail).addClass("order_waiting");			
	}
	else if($(order_detail).hasClass("order_waiting")){
		
	}
	else{
		alert('error occured');
	}
}

function order_status_up(id){
	order_detail = "#order_detail_" + id;
	if( $(order_detail).hasClass("order_waiting")){
		$(order_detail).removeClass("order_waiting");
		$(order_detail).addClass("order_making");		
	}
	else if( $(order_detail).hasClass("order_making") ){
		$(order_detail).removeClass("order_making");
		$(order_detail).addClass("order_done");			
	}
	else if($(order_detail).hasClass("order_done")){
		
	}
	else{
		alert('error occured');
	}
}


//-------------------------------單子的顯示設定---------------------------------->
$('.viewshare').hide();



$('.order_title').on("click", function(e){	
	//alert( $(e.target));//
	
	$(this).next('.order_detail').toggle();
	//alert('ot');
});

$('.button_calshare').on( "click", function(e){
	
	$(this).parents('.order_title').next('.order_detail').children('.viewsummary').hide();
	$(this).parents('.order_title').next('.order_detail').children('.viewshare').show();
	$(this).addClass("ui-btn-active");
	 $(this).parent().children('.button_viewsum').removeClass("ui-btn-active");
	 e.stopImmediatePropagation();
});

$('.button_viewsum').on( "click", function(e){
	$(this).parents('.order_title').next('.order_detail').children('.viewsummary').show();
	$(this).parents('.order_title').next('.order_detail').children('.viewshare').hide();
	$(this).addClass("ui-btn-active");
	$(this).parent().children('.button_calshare').removeClass("ui-btn-active");
	 e.stopImmediatePropagation();
});

//$('#order_list').


var order_swipeleft = function(e){
	order_status_down( $(this).attr('order_id'));
};
	
var order_swiperight = function(e){
	order_status_up( $(this).attr('order_id'));
};
	
$(".order_detail").on("swipeleft", order_swipeleft);
$(".order_title").on("swipeleft", order_swipeleft);
$(".order_detail").on("swiperight",order_swiperight);
$(".order_title").on("swiperight",order_swiperight);

</script>

<!---  {{series.main.ai.name}} ---->
<p> </p>
</div>
</body>
</html>