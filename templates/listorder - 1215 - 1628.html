<!DOCTYPE html>


<html>

<head>
<title>W3.CSS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="./templates/w3.css">

<link rel="stylesheet" href="includes/jquery/mobile/jquery.mobile-1.4.5.min.css">
<script type="text/javascript" src="includes/jquery/jquery-1.11.3.min.js" ></script>
<script type="text/javascript" src="includes/jquery/mobile/jquery.mobile-1.4.5.min.js" ></script>

</head>
<body>

<nav class="w3-sidenav w3-white w3-card-2" style="display:none">
  <a href="javascript:void(0)" 
  onclick="w3_close()"
  class="w3-closenav w3-large w3-xxlarge w3-center">&times;</a>
  <a href="#a0" class="w3-center">即時訂單資訊</a>		
  <br>
  <a href="#a1" class="w3-center">報表產生</a>		
  <br>
  <a href="#a2" class="w3-center">菜單更新</a>		
  <br>
  <a href="login.php" class="w3-center">登出</a>
</nav>

<div data-role="page"  id="main">



<div >

    <header class="w3-container w3-teal">
      <span class="w3-opennav w3-xlarge" onclick="w3_open()">&#9776;</span>
      <h1><center>早餐店後台管理系統</center></h1>
    </header>


    <div id="a0" class="w3-container">
        <h3><center>即時訂單資訊</center></h3>
    <table class="w3-table w3-bordered w3-striped w3-border w3-hoverable" id="allorders" >
        <tr>
		<td>狀態</td>
		<td>桌號</td>
		<td>人數</td>
		<td>總價錢</td>
		<td>操作</td>
        </tr>
	<!----- Order START ------>
	<tr onClick="toggle_ordershow(1)" id="order_title_1" class="order_title" order_id="1"> <!---- order title (with id 1)   ---->
		<td>已出餐</td>
		<td>#12</td>
		<td>3</td>
		<td>$160</td>
		<td>
		         <ul data-role="controlgroup" data-type="horizontal" class="localnav">
				<!--- <input type="button" value="單子總結" order_id="1" data-role="button" data-transition="fade"  class="button_viewsum ui-btn-active">
				<input type="button" value="計算小單價格" class="button_calshare" order_id="1" data-role="button">--->
				
				<a href="#" data-role="button" data-transition="fade" class="button_viewsum ui-btn-active" order_id="1">單子總結</a>
				<a href="#" data-role="button" data-transition="fade" class="button_calshare" >計算小單價格</a>
			</ul>	

			<!--- <input type="button" value="封存" class="button_done" order_id="1"> --->
		</td>
        </tr>
	<tr id="order_detail_1" class="order_detail order_done" order_id="1"> 
	    <td colspan=5>
		<!--- viewsummary ---->
		<table class="w3-table w3-bordered w3-striped w3-border w3-hoverable viewsummary">
			<tr><td>漢堡</td><td>加起司</td><td>$50</td><td>x1</td>
				
			</tr>
			<tr><td>沙拉</td><td>加起司</td><td>$70</td><td>x1</td>
				
			</tr>
			<tr><td>豆漿</td><td>溫,無糖</td><td>$20</td><td>x3</td>
				
			</tr>
		</table>
		<!--- viewshare ---->
		<table class="w3-table w3-bordered w3-striped w3-border w3-hoverable viewshare">
		<tr><td class="col1" >$70</td>
			<td>
			<table class="w3-table w3-bordered w3-striped w3-border w3-hoverable">
				<tr><td>漢堡</td><td>加起司</td><td>$50</td><td>x1</td></tr>
				<tr><td>豆漿</td><td>溫,無糖</td><td>$20</td><td>x1</td></tr>
			</table>
			</td>
		</tr>
		<tr><td class="col1">$90</td>
			<td>
			<table class="w3-table w3-bordered w3-striped w3-border w3-hoverable">
				<tr><td>沙拉</td><td>加起司</td><td>$70</td><td>x1</td></tr>
				<tr><td>豆漿</td><td>溫,無糖</td><td>$20</td><td>x1</td></tr>
			</table>
			</td>
		</tr>		
		<tr><td class="col1">$20</td>
			<td>
			<table class="w3-table w3-bordered w3-striped w3-border w3-hoverable">
				<tr><td>豆漿</td><td>溫,無糖</td><td>$20</td><td>x1</td></tr>
			</table>
			</td>
		</tr>		
		</table>
            </td>
	</tr>
	<!----- Order END ------>


	
    </table>
    </div>
    
    <div>&nbsp;</div>
 
    <footer class="w3-container w3-teal">
      <p> &nbsp; </p>
    </footer>

</div>
      
<script>

//--------單子顯示相關的函式------------------------------
//
//	ordershow 顯示整張單子，包含viewsummary跟viewshare
//	viewsummary 單子總結
//	viewshare 以小單為單位顯示
//
//--------------------------------------------------------

function toggle_ordershow( id ){
	order_filter = "#order_detail_"+id;
	$(order_filter).toggle();
}

function show_ordershow( id ){
	order_filter = "#order_detail_"+id;
	$(order_filter).show();
}
function toggle_viewsummary( id ){
	summary_filter = "#order_detail_"+id+" .viewsummary";
	$(summary_filter).toggle();
}


function show_viewsummary( id ){
	summary_filter = "#order_detail_"+id+" .viewsummary";
	$(summary_filter).show();
}

function show_viewshare( id ){
	shareprice_filter = "#order_detail_"+id+" .viewshare";
	$(shareprice_filter).show();
	
	shareprice_filter = "#order_detail_"+id+" .col1";
	$(shareprice_filter).show();	
}

function hide_viewsummary( id ){
	summary_filter = "#order_detail_"+id+" .viewsummary";
	$(summary_filter).hide();
	shareprice_filter = "#order_detail_"+id+" .col1";
	$(shareprice_filter).hide();	
}

function hide_viewshare( id ){
	shareprice_filter = "#order_detail_"+id+" .viewshare";
	$(shareprice_filter).hide();
}

function order_status_down(id){
	order_detail = "#order_detail_" + id;
	if( $(order_detail).hasClass("order_done")){
		$(order_detail).removeClass("order_done");
		$(order_detail).addClass("order_making");		
	}
	else if( $(order_detail).hasClass("order_making") ){
		$(order_detail).removeClass("order_making");
		$(order_detail).addClass("order_waiting");			
	}
	else if($(order_detail).hasClass("order_waiting")){
		
	}
	else{
		alert('error occured');
	}
}

function order_status_up(id){
	order_detail = "#order_detail_" + id;
	if( $(order_detail).hasClass("order_waiting")){
		$(order_detail).removeClass("order_waiting");
		$(order_detail).addClass("order_making");		
	}
	else if( $(order_detail).hasClass("order_making") ){
		$(order_detail).removeClass("order_making");
		$(order_detail).addClass("order_done");			
	}
	else if($(order_detail).hasClass("order_done")){
		
	}
	else{
		alert('error occured');
	}
}


//-------------------------------單子的顯示設定---------------------------------->
$('.viewshare').hide();
$('.button_calshare').click(function(e){
	//alert();
	target_oid = $(this).parents('.order_title').attr('order_id');
	show_ordershow( target_oid);
	hide_viewsummary(target_oid);
	show_viewshare(target_oid);
	$(this).addClass('ui-btn-active');
	//$(this).parent.('.button_viewsum').removeClass('ui-btn-active');
	//ui-btn-active 
	
	order_title = "#order_title_" + target_oid ;
	$( order_title +  " .button_viewsum").removeClass('ui-btn-active');
	
	//alert(') );
	e.stopPropagation();
});

//toggle_viewsummary
$('.button_viewsum').click(function(e){
	//alert();
	show_ordershow( $(this).attr('order_id') );
	hide_viewshare($(this).attr('order_id'));
	show_viewsummary($(this).attr('order_id'));
	$(this).addClass('ui-btn-active');

	order_title = "#order_title_" + target_oid ;
	$( order_title +  " .button_calshare").removeClass('ui-btn-active');
	
	e.stopPropagation();
});
//$(".order_detail").click(function(){
//	alert('ahh');
//});
//$(document).on("pagecreate", "#main", function(){


//});
	var order_swipeleft = function(e){
		order_status_down( $(this).attr('order_id'));
	};
	
	var order_swiperight = function(e){
		order_status_up( $(this).attr('order_id'));
	};
	
	$(".order_detail").on("swipeleft", order_swipeleft);
	$(".order_title").on("swipeleft", order_swipeleft);
	$(".order_detail").on("swiperight",order_swiperight);
	$(".order_title").on("swiperight",order_swiperight);

/*
$(".order_detail").on("swiperight",function{沙拉	加起司	$7
	alert('right');
});
*/


//w3_open();
function w3_open() {
  document.getElementById("main").style.marginLeft = "25%"
 document.getElementsByClassName("w3-sidenav")[0].style.width ="25%";
  document.getElementsByClassName("w3-sidenav")[0].style.display = "block";
  document.getElementsByClassName("w3-opennav")[0].style.display = 'none';
}
function w3_close() {
  document.getElementById("main").style.marginLeft = "0%";
  document.getElementsByClassName("w3-sidenav")[0].style.display = "none";
  document.getElementsByClassName("w3-opennav")[0].style.display = "inline-block";
}

</script>

<!---  {{series.main.ai.name}} ---->
<p> </p>
</div>
</body>
</html>